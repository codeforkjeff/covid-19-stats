version: 1
send_anonymous_usage_stats: false
project_id: c8c451df-26dc-4a66-a64b-6ac434c5922e
plugins:
  extractors:
  - name: tap-spreadsheets-anywhere
    variant: ets
    pip_url: git+https://github.com/ets/tap-spreadsheets-anywhere.git
    config:
      tables:
      - path: file://stage
        pattern: raw_csse.csv
        name: raw_csse
        start_date: '2017-05-01T00:00:00Z'
        key_properties:
        - Date
        - Combined_Key
        format: csv
      - path: file://stage
        pattern: cdc_states.csv
        name: raw_cdc_states
        start_date: '2017-05-01T00:00:00Z'
        key_properties:
        - submission_date
        - state
        format: csv
      - path: file://stage
        pattern: cdc_deaths_2014_2018.csv
        name: raw_cdc_deaths_2014_2018
        start_date: '2017-05-01T00:00:00Z'
        key_properties:
        - date
        - state
        format: csv
      - path: file://stage
        pattern: cdc_deaths_2019_2020.csv
        name: raw_cdc_deaths_2019_2020
        start_date: '2017-05-01T00:00:00Z'
        key_properties:
        - date
        - state
        format: csv
      - path: file://stage
        pattern: cdc_surveillance_cases.csv
        name: raw_cdc_surveillance_cases
        start_date: '2017-05-01T00:00:00Z'
        # this file doesn't actually have a key
        key_properties:
        - cdc_case_earliest_dt
        format: csv
      - path: file://stage
        pattern: dhhs_testing.csv
        name: raw_dhhs_testing
        start_date: '2017-05-01T00:00:00Z'
        key_properties:
        - state
        - overall_outcome
        - date
        format: csv
    metadata:
      raw_csse:
        replication-method: INCREMENTAL
        replication-key: _updated_at
  - name: tap-csse
    inherit_from: tap-spreadsheets-anywhere
    select_filter:
    - raw_csse
  - name: tap-cdc-states
    inherit_from: tap-spreadsheets-anywhere
    select_filter:
    - raw_cdc_states
  - name: tap-cdc-deaths
    inherit_from: tap-spreadsheets-anywhere
    select_filter:
    - raw_cdc_deaths_2014_2018
    - raw_cdc_deaths_2019_2020
  - name: tap-cdc-surveillance-cases
    inherit_from: tap-spreadsheets-anywhere
    select_filter:
    - cdc-surveillance-cases
  - name: tap-dhhs-testing
    inherit_from: tap-spreadsheets-anywhere
    select_filter:
    - raw_dhhs_testing
  - name: tap-reference-data
    inherit_from: tap-spreadsheets-anywhere
    select_filter:
    - raw_dhhs_testing
  loaders:
  - name: target-bigquery
    variant: adswerve
    pip_url: git+https://github.com/adswerve/target-bigquery.git@0.11.3
    config:
      project_id: covid-19-stats-294405
      dataset_id: source_tables
      location: us
  - name: target-bigquery-reload
    inherit_from: target-bigquery
    config:
      replication_method: truncate
  orchestrators:
  - name: airflow
    pip_url: apache-airflow==2.1.2 --constraint https://raw.githubusercontent.com/apache/airflow/constraints-2.1.2/constraints-${MELTANO__PYTHON_VERSION}.txt
  transformers:
  - name: dbt
    pip_url: dbt==0.21.1
  files:
  - name: dbt
    pip_url: git+https://gitlab.com/meltano/files-dbt.git@config-version-2
  - name: airflow
    pip_url: git+https://gitlab.com/meltano/files-airflow.git
schedules:
- name: load-csse
  extractor: tap-csse
  loader: target-bigquery
  transform: run
  interval: '@daily'
  start_date: 2021-12-21 19:32:34.591732
# - name: load-incremental
#   extractor: tap-incremental
#   loader: target-bigquery
#   transform: run
#   interval: '@daily'
#   start_date: 2021-12-23 19:32:34.591732
